<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Devolução</title>
    <link rel="icon" type="image/png" href="../image/zenirlogo.png">
    <link rel="stylesheet" href="../css/declaracoes.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container-header">
            <button class="btn-voltar" id="btnVoltar">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
                Voltar
            </button>
            

        </div>
    </header>

    <!-- Dashboard Container -->
    <div class="dashboard">
        <!-- Ícones Flutuantes -->
        <div class="icones-flutuantes" id="iconesFlutuantes">
            <div class="icone-flutuante" style="top: 15%; left: 15%;">
                <svg width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
                    <line x1="1" y1="10" x2="23" y2="10"></line>
                </svg>
            </div>
            
            <div class="icone-flutuante" style="top: 60%; left: 20%;">
                <svg width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <line x1="16" y1="13" x2="8" y2="13"></line>
                    <line x1="16" y1="17" x2="8" y2="17"></line>
                </svg>
            </div>
            
            <div class="icone-flutuante" style="top: 20%; right: 20%;">
                <svg width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                    <line x1="8" y1="21" x2="16" y2="21"></line>
                    <line x1="12" y1="17" x2="12" y2="21"></line>
                </svg>
            </div>
            
            <div class="icone-flutuante" style="top: 65%; right: 15%;">
                <img src="../image/zenirlogo.png" width="60" alt="Logo">
            </div>
        </div>

        <!-- Botão Central -->
        <div class="botao-central" id="botaoCentral">
            <button class="botao-abrir-form" id="btnAbrirFormulario">
                <div class="botao-icon">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                    </svg>
                </div>
                <h2>Abrir Formulário de Preenchimento</h2>
                <p>Preencha os dados da declaração de devolução</p>
            </button>
        </div>

        <!-- Formulário de Preenchimento -->
        <div class="formulario-layout" id="formularioLayout">
            <!-- Sidebar Esquerda -->
            <aside class="sidebar">
                <!-- Círculo de Progresso -->
                <div class="progresso-card">
                    <div class="progresso-header">
                        <h3>Progresso</h3>
                    </div>
                    
                    <div class="progress-ring">
                        <svg class="progress-svg" viewBox="0 0 200 200">
                            <defs>
                                <linearGradient id="progressGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color:#10b981;stop-opacity:1" />
                                    <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />
                                </linearGradient>
                            </defs>
                            <circle class="progress-bg" cx="100" cy="100" r="90"></circle>
                            <circle class="progress-bar" cx="100" cy="100" r="90"></circle>
                        </svg>
                        <div class="progress-label" id="progressoPorcentagem">0%</div>
                    </div>

                    <div class="progresso-info">
                        <span id="progressoTexto">Preencha os campos obrigatórios</span>
                    </div>
                </div>

                <!-- Botões de Ação -->
                <div class="acoes-card">
                    <button class="btn-acao btn-limpar" id="btnLimpar">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="3 6 5 6 21 6"></polyline>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                        </svg>
                        Limpar Campos
                    </button>
                    
                    <button class="btn-acao btn-gerar" id="btnGerarPDF">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        Gerar PDF
                    </button>

                    <button class="btn-acao btn-fechar" id="btnFecharFormulario">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                        Fechar Formulário
                    </button>
                </div>
            </aside>

            <!-- Conteúdo Principal -->
            <main class="formulario-container">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Declaração de Devolução</h2>
                    </div>
                    
                    <form id="formularioDeclaracao">
                        <!-- Primeira Linha: NF-e | Nome | CPF | Filial -->
                        <div class="form-row-4">
                            <div class="form-group">
                                <label for="numeroNFe">NF-e de Devolução</label>
                                <input type="text" id="numeroNFe" placeholder="Nº NF-e">
                            </div>
                            <div class="form-group">
                                <label for="nomeCliente">Nome do Cliente <span class="obrigatorio">*</span></label>
                                <input type="text" id="nomeCliente" placeholder="Nome completo">
                            </div>
                            <div class="form-group">
                                <label for="cpf">CPF <span class="obrigatorio">*</span></label>
                                <input type="text" id="cpf" placeholder="000.000.000-00" maxlength="14">
                            </div>
                            <div class="form-group form-small">
                                <label for="filial">Filial <span class="obrigatorio">*</span></label>
                                <input type="text" id="filial" placeholder="Filial">
                            </div>
                        </div>

                        <!-- Produtos -->
                        <div class="form-section">
                            <h3>Produtos <span class="obrigatorio">*</span> <small>(Preencha ao menos 1 produto completo)</small></h3>
                            <div id="listaProdutos"></div>
                        </div>

                        <!-- Endereço | Bairro | Número | Cidade | UF -->
                        <div class="form-row-5">
                            <div class="form-group form-col-2">
                                <label for="endereco">Endereço <span class="obrigatorio">*</span></label>
                                <div class="input-group">
                                    <input type="text" id="endereco" placeholder="Rua, Avenida...">
                                    <button type="button" class="btn-search" id="btnBuscarCEP" title="Buscar por CEP">
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <circle cx="11" cy="11" r="8"></circle>
                                            <path d="m21 21-4.35-4.35"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="bairro">Bairro</label>
                                <input type="text" id="bairro" placeholder="Bairro">
                            </div>
                            <div class="form-group form-small">
                                <label for="numero">Número</label>
                                <input type="text" id="numero" placeholder="Nº">
                            </div>
                            <div class="form-group">
                                <label for="cidade">Cidade</label>
                                <input type="text" id="cidade" placeholder="Cidade">
                            </div>
                            <div class="form-group form-small">
                                <label for="estado">UF</label>
                                <input type="text" id="estado" placeholder="UF" maxlength="2">
                            </div>
                        </div>

                        <!-- PV | Cupom | Nova Compra | Novo PV -->
                        <div class="form-row-4">
                            <div class="form-group">
                                <label for="pv">PV <span class="obrigatorio">*</span></label>
                                <input type="text" id="pv" placeholder="PV">
                            </div>
                            <div class="form-group">
                                <label for="cupomNFe">Cupom/NF-e/NFC-e <span class="obrigatorio">*</span></label>
                                <input type="text" id="cupomNFe" placeholder="Cupom/NF-e/NFC-e">
                            </div>
                            <div class="form-group">
                                <label for="outraCompra">Cliente efetuou nova compra?</label>
                                <select id="outraCompra">
                                    <option value="">Selecione</option>
                                    <option value="Sim">Sim</option>
                                    <option value="Não">Não</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="novoPV">Novo PV</label>
                                <input type="text" id="novoPV" placeholder="Novo PV" disabled>
                            </div>
                        </div>

                        <!-- Motivo -->
                        <div class="form-group">
                            <label for="motivoDevolucao">Motivo da Devolução <span class="obrigatorio">*</span></label>
                            <textarea id="motivoDevolucao" rows="3" placeholder="Descreva o motivo da devolução"></textarea>
                        </div>
                    </form>
                </div>
            </main>
        </div>
    </div>

    <!-- Modal de Busca de CEP -->
    <div id="modalCEP" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Buscar Endereço por CEP</h3>
                <button class="modal-close" id="btnFecharModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="inputCEP">Digite o CEP</label>
                    <input type="text" id="inputCEP" placeholder="00000-000" maxlength="9">
                </div>
                <div id="resultadoCEP" class="resultado-cep"></div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="btnCancelarCEP">Cancelar</button>
                <button class="btn-primary" id="btnPesquisarCEP">Pesquisar</button>
            </div>
        </div>
    </div>

    <!-- Modal de Confirmação -->
    <div id="modalConfirmacao" class="modal">
        <div class="modal-content modal-confirmacao">
            <div class="modal-icon warning" id="modalIcon">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"></path>
                    <line x1="12" y1="9" x2="12" y2="13"></line>
                    <line x1="12" y1="17" x2="12.01" y2="17"></line>
                </svg>
            </div>
            <h3 id="modalTitulo">Confirmar ação?</h3>
            <p id="modalMensagem">Mensagem de confirmação</p>
            <div class="modal-footer">
                <button class="btn-secondary" id="btnCancelar">Cancelar</button>
                <button class="btn-danger" id="btnConfirmar">Confirmar</button>
            </div>
        </div>
    </div>

    <!-- Overlay de Loading -->
    <div id="overlayLoading" class="overlay-loading">
        <div class="spinner"></div>
        <p id="loadingText">Carregando...</p>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Script JavaScript -->
    <script src="../js/declaracoes.js"></script>
    <script src="../js/session-guard.js"></script>
</body>
</html>
